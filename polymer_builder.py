from PolymerChain import PolymerChain

###############################
#####################################################################################################################################################################################################################
# code to EXECute#####################################################################################################################################################################################################
#####################################################################################################################################################################################################################
chain = PolymerChain(
    "p1",
    monomers=["AMC"],
    n_of_monomers=[45],
    toppar="cg_dihe.str",
    charmm="charmm",
)
# chain.build_Monomers(verbose=True)
chain.build_simpleChain(verbose=True, iter=0)  # , random=True)
chain.relax_chain(500)
chain.solvate(
    1,
    "BMW",
    200_000,
    verbose=True,
    boxsize=2500,
    salt=True,
    c="MG",
    c_pdb="mg.pdb",
    c_n=90,
    a="SO4",
    a_pdb="so4.pdb",
    a_n=90,
)
chain.equilibrate("p1_in_bmw.psf", "p1_bmw.pdb", nstep=50_000_000)
chain.restart(
    "p1_in_bmw.psf",
    "p1.rst",
    nstep=5_000_000,
    dt2p=[1, 1, 1, 1, 1, 1],
    boxl=48,
)
######################################################################################################################################################################################################################
#####################################################################################################################################################################################################################
